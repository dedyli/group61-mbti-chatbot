<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mind-Mapper AI â€” Personality Insights & Conflict Resolution</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet" />
  <style>
    :root{ 
      --bg:#0b0a13; --fg:#f7f5ff; --muted:#bdb7e6; 
      --accent:#8B5CF6; --accent-2:#F0A6FF; --gold:#EED972; 
      --conflict:#FF6B6B; --conflict-2:#FF8A8A; --harmony:#4ECDC4;
      --glass:rgba(255,255,255,.08); --glass-stroke:rgba(255,255,255,.12); 
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{ margin:0; color:var(--fg); background:transparent; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; overflow-x:hidden; }

    /* Multilingual helpers */
    [data-lang]{display:none}
    body.lang-en [data-lang="en"], body.lang-en .block-en{display:initial}
    body.lang-vi [data-lang="vi"], body.lang-vi .block-vi{display:initial}
    body.lang-zh [data-lang="zh"], body.lang-zh .block-zh{display:initial}

    /* Service-specific display */
    .service-section { display: none; animation: fadeIn 0.5s ease-in-out; }
    .service-section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .aurora{position:fixed; inset:0; z-index:-2; pointer-events:none; background:
      radial-gradient(60vw 60vw at -10% -10%, rgba(139,92,246,.35), transparent 60%),
      radial-gradient(50vw 50vw at 110% 10%, rgba(240,166,255,.25), transparent 60%),
      radial-gradient(40vw 40vw at 50% 110%, rgba(238,217,114,.18), transparent 60%),
      radial-gradient(25vw 25vw at 20% 70%, rgba(139,92,246,.18), transparent 70%),
      var(--bg);
      filter:saturate(120%) blur(10px); animation:auroraShift 24s ease-in-out infinite alternate; }
    @keyframes auroraShift{to{transform:translateY(-2%) scale(1.02)}}
    
    .sparkles{position:fixed; inset:0; z-index:-1; pointer-events:none}
    .sparkles i{position:absolute; width:3px; height:3px; border-radius:50%; background:rgba(255,255,255,.85); filter:blur(.3px); opacity:.7; animation:float 16s linear infinite, twinkle 2.5s ease-in-out infinite alternate}
    @keyframes float{to{transform:translateY(-120vh)}}
    @keyframes twinkle { 0% { opacity: .3; filter: blur(.3px) brightness(0.9); } 100% { opacity: 1; filter: blur(.3px) brightness(1.1); } }

    header{ position:sticky; top:16px; z-index:50; display:flex; gap:16px; align-items:center; justify-content:space-between; margin:16px auto 0; max-width:1200px; padding:12px 16px; border-radius:20px; background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06)); -webkit-backdrop-filter:blur(14px) saturate(140%); backdrop-filter:blur(14px) saturate(140%); border:1px solid var(--glass-stroke); box-shadow:0 8px 28px rgba(0,0,0,.25); }
    .brand{display:flex; align-items:center; gap:12px}
    .brand img{width:120px; height:40px; object-fit:contain; border-radius:8px; box-shadow:0 6px 16px rgba(0,0,0,.35)}
    .brand h1{margin:0; font-family:'Playfair Display',serif; font-weight:800; font-size:20px; letter-spacing:.3px}
    
    nav ul{margin:0; padding:0; list-style:none; display:flex; gap:8px; align-items:center}
    nav a{ color:var(--fg); text-decoration:none; font-weight:600; font-size:14px; letter-spacing:.3px; padding:10px 14px; border-radius:12px; position:relative; overflow:hidden; transition: all .3s ease; }
    nav a:after{content:""; position:absolute; inset:0; background:linear-gradient(90deg,var(--accent),var(--accent-2)); opacity:0; transition:.35s}
    nav a:hover:after{opacity:.25}
    nav a.active{font-weight:700; box-shadow:0 4px 20px rgba(139,92,246,.4);}
    nav a.active:after{opacity:.25}

    /* Service-specific nav styling */
    nav a.personality-service {
      background: rgba(139,92,246,.1);
      border: 1px solid rgba(139,92,246,.2);
    }
    nav a.personality-service:hover, nav a.personality-service.active {
      background: rgba(139,92,246,.2);
      box-shadow: 0 8px 25px rgba(139,92,246,.3);
    }
    
    nav a.conflict-service {
      background: rgba(255,107,107,.1);
      border: 1px solid rgba(255,107,107,.2);
    }
    nav a.conflict-service:hover, nav a.conflict-service.active {
      background: rgba(255,107,107,.2);
      box-shadow: 0 8px 25px rgba(255,107,107,.3);
    }

    /* Language pill */
    .lang{display:flex; align-items:center; gap:8px}
    .pill{border:1px solid #6b61b8; background:rgba(14,12,30,.85); padding:8px 10px; border-radius:999px; display:flex; align-items:center; gap:8px; box-shadow:0 8px 24px rgba(0,0,0,.45)}
    .pill select{background:rgba(29,25,58,.95); border:1px solid #8B5CF6; color:#f3f0ff; font-weight:700; padding:8px 10px; border-radius:999px; outline:none; appearance:none}
    .pill select option{background:#1f1a3f; color:#f3f0ff;}

    .container{max-width:1200px; margin:0 auto; padding:64px 16px}

    /* Service Hero Sections */
    .service-hero{display:grid; grid-template-columns:1.1fr .9fr; align-items:center; gap:48px; padding-top:48px}
    .service-title{ font-family:'Playfair Display',serif; font-weight:800; font-size:clamp(36px,6vw,64px); line-height:1.04; letter-spacing:-.3px; margin:0 0 16px; position:relative; }
    
    .personality-title {
      background:linear-gradient(180deg,#fff, #d7d0ff 60%, #b9b0ff); 
      -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; 
      text-shadow:0 8px 28px rgba(139,92,246,.15);
    }
    .conflict-title {
      background:linear-gradient(180deg,#fff, #ffcccb 60%, #ff9999); 
      -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; 
      text-shadow:0 8px 28px rgba(255,107,107,.15);
    }

    .subtitle{color:var(--muted); font-weight:600; font-size:18px; margin-bottom:20px}
    .lead{color:#dbd7ff; opacity:.9; max-width:56ch; line-height:1.8; margin-bottom:28px}
    
    .service-cta{ display:inline-flex; gap:10px; align-items:center; padding:14px 18px; border-radius:14px; font-weight:700; text-decoration:none; transition:transform .2s ease, box-shadow .2s ease; }
    .personality-cta{ color:#0b0a13; background:linear-gradient(90deg, var(--gold), #FFEBA4); box-shadow:0 10px 30px rgba(238,217,114,.35); }
    .personality-cta:hover{transform:translateY(-2px); box-shadow:0 16px 36px rgba(238,217,114,.45)}
    .conflict-cta{ color:#fff; background:linear-gradient(90deg, var(--conflict), var(--conflict-2)); box-shadow:0 10px 30px rgba(255,107,107,.35); }
    .conflict-cta:hover{transform:translateY(-2px); box-shadow:0 16px 36px rgba(255,107,107,.45)}

    .illustrationWrap{position:relative}
    .card3d{ position:relative; border-radius:24px; overflow:hidden; border:1px solid var(--glass-stroke); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); box-shadow:0 30px 80px rgba(0,0,0,.35); transform:perspective(1000px) rotateX(0) rotateY(0); transition:transform .2s ease }
    .hero-img{display:block; width:100%; height:auto; aspect-ratio:4/3; object-fit:cover}

    .section{padding:72px 0}
    .section h2{font-family:'Playfair Display',serif; font-size:clamp(28px,3.2vw,40px); margin:0 0 24px}
    .muted{color:var(--muted)}

    /* Feature grids */
    .feature-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:24px; margin-top:50px}
    .feature-card{ background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); border:1px solid var(--glass-stroke); border-radius:20px; padding:22px; position:relative; overflow:hidden; transition:transform .25s ease, box-shadow .25s ease }
    .feature-card:hover{transform:translateY(-6px); box-shadow:0 24px 60px rgba(0,0,0,.35)}
    .feature-card h3{margin:12px 0 8px; font-weight:800}
    .feature-card p{margin:0; color:#e9e7ff; opacity:.9}

    .personality-card h3 { color: var(--accent-2); }
    .conflict-card h3 { color: var(--conflict); }

    /* When to use sections */
    .when-to-use{background:rgba(255,255,255,.05); border-radius:20px; padding:30px; margin:40px 0; border:1px solid var(--glass-stroke)}
    .when-to-use h3{margin:0 0 20px; text-align:center; font-size:24px; font-weight:700}
    .use-cases{display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px}
    .use-case{background:rgba(255,255,255,.03); padding:16px; border-radius:12px; text-align:center}

    /* Steps */
    .steps{display:grid; grid-template-columns:repeat(3,1fr); gap:16px}
    .step{ background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); border:1px solid var(--glass-stroke); border-radius:20px; padding:22px; position:relative; overflow:hidden; transition:transform .25s ease, box-shadow .25s ease }
    .step:hover{transform:translateY(-6px); box-shadow:0 24px 60px rgba(0,0,0,.35)}
    .step .n{width:38px; height:38px; display:grid; place-items:center; border-radius:999px; font-weight:800; color:#0b0a13; margin-bottom:12px}
    .step h3{margin:12px 0 8px; font-weight:800}
    .step p{margin:0; color:#e9e7ff; opacity:.9}

    .personality-step .n { background:linear-gradient(90deg,var(--accent),var(--accent-2)); box-shadow:0 8px 22px rgba(139,92,246,.45); }
    .conflict-step .n { background:linear-gradient(90deg,var(--conflict),var(--conflict-2)); box-shadow:0 8px 22px rgba(255,107,107,.45); }

    /* FAQ */
    .faq{max-width:920px}
    details{background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03)); border:1px solid var(--glass-stroke); border-radius:16px; padding:18px 20px; margin:10px 0}
    summary{cursor:pointer; font-weight:700}
    details[open]{box-shadow:0 16px 40px rgba(0,0,0,.35)}

    /* Contact form */
    form{max-width:760px}
    input,textarea,select,button{font-family:inherit}
    .field{display:grid; gap:8px}
    .field input,.field textarea{ background:rgba(255,255,255,.04); border:1px solid var(--glass-stroke); color:var(--fg); padding:14px 16px; border-radius:12px }
    .btn{ border:none; cursor:pointer; padding:14px 18px; border-radius:14px; font-weight:800; letter-spacing:.3px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#0b0a13; box-shadow:0 12px 34px rgba(139,92,246,.35) }

    /* Chat systems */
    .chat-launch{ 
      position:fixed; right:18px; bottom:18px; z-index:10000; width:240px; height:240px; 
      border:none; background:transparent; cursor:pointer; padding:0;
      animation:mascotFloat 3s ease-in-out infinite, mascotGlow 2s ease-in-out infinite alternate;
    }
    .chat-launch img {
      width:100%; height:100%; object-fit:contain; border-radius:50%; 
      filter:drop-shadow(0 0 20px rgba(139,92,246,.6)) drop-shadow(0 0 40px rgba(139,92,246,.4)) drop-shadow(0 0 60px rgba(139,92,246,.2));
      transition:transform .3s ease, filter .3s ease;
    }
    .chat-launch:hover img {
      transform:scale(1.1) rotate(5deg);
      filter:drop-shadow(0 0 25px rgba(139,92,246,.8)) drop-shadow(0 0 50px rgba(139,92,246,.6)) drop-shadow(0 0 80px rgba(139,92,246,.4));
    }
    .chat-launch.conflict img {
      filter:drop-shadow(0 0 20px rgba(255,107,107,.6)) drop-shadow(0 0 40px rgba(255,107,107,.4)) drop-shadow(0 0 60px rgba(255,107,107,.2));
    }
    .chat-launch.conflict:hover img {
      filter:drop-shadow(0 0 25px rgba(255,107,107,.8)) drop-shadow(0 0 50px rgba(255,107,107,.6)) drop-shadow(0 0 80px rgba(255,107,107,.4));
    }
    @keyframes mascotFloat { 0%, 100% { transform:translateY(0px); } 50% { transform:translateY(-15px); } }
    @keyframes mascotGlow { 0% { filter:drop-shadow(0 0 20px rgba(139,92,246,.6)) drop-shadow(0 0 40px rgba(139,92,246,.4)); } 100% { filter:drop-shadow(0 0 30px rgba(139,92,246,.8)) drop-shadow(0 0 60px rgba(139,92,246,.6)); } }
    
    .chat-panel{ 
        position:fixed; right:18px; bottom:270px; width:min(420px, calc(100vw - 32px)); height:min(68vh, 720px); 
        border-radius:24px; overflow:hidden; display:none; flex-direction:column; z-index:9999; 
        background:linear-gradient(178deg, rgba(11,10,19,.85), rgba(16,15,22,.85)); 
        -webkit-backdrop-filter:blur(20px) saturate(140%); backdrop-filter:blur(20px) saturate(140%); 
        border:1px solid var(--glass-stroke); box-shadow:0 30px 80px rgba(0,0,0,.55); 
    }
    .chat-panel.open { display:flex; }
    .chat-head{ padding:12px 16px; flex-shrink:0; border-bottom:1px solid rgba(255,255,255,.12); }
    .personality-head { background:linear-gradient(90deg, #241b5f, #3c2c9f 45%, #6d4df7); }
    .conflict-head { background:linear-gradient(90deg, #5f1b1b, #9f2c2c 45%, #f74d4d); }
    .chat-head h3{ margin:0; font-family:'Playfair Display',serif; letter-spacing:.3px; font-weight:800; }
    .chat-body{ padding:14px; flex-grow:1; overflow:auto; display:flex; flex-direction:column; gap:12px }

    .msg{display:flex; gap:10px; align-items:flex-start}
    .msg .bubble{max-width:85%; padding:12px 14px; border-radius:14px; line-height:1.6}
    .msg.user{justify-content:flex-end}
    .msg.user .bubble{color:#0b0a13; border-top-right-radius:4px}
    .msg.user.personality .bubble{background:linear-gradient(90deg,var(--accent),var(--accent-2))}
    .msg.user.conflict .bubble{background:linear-gradient(90deg,var(--conflict),var(--conflict-2))}
    .msg.ai .bubble{background:rgba(255,255,255,.06); border:1px solid var(--glass-stroke); border-top-left-radius:4px}
    
    .chat-foot{ padding:12px; border-top:1px solid var(--glass-stroke); display:grid; grid-template-columns:1fr; gap:8px; flex-shrink:0; background:rgba(255,255,255,.02); }
    .chat-foot input{background:rgba(255,255,255,.06); border:1px solid var(--glass-stroke); color:var(--fg); padding:12px 14px; border-radius:12px; width:100%; outline:none}
    .chat-foot input:focus{border-color:rgba(139,92,246,.6); box-shadow:0 0 0 3px rgba(139,92,246,.25)}
    .notice{font-size:12px; color:#cfcaff; opacity:.8; padding:8px 12px;}
    
    .feedback-buttons { margin-top: 10px; display: flex; gap: 8px; }
    .feedback-buttons button { background: rgba(255,255,255,.1); border: 1px solid var(--glass-stroke); color: var(--fg); padding: 4px 10px; border-radius: 8px; cursor: pointer; transition: background .2s; font-size: 12px; }
    .feedback-buttons button:hover { background: rgba(255,255,255,.2); }
    .feedback-buttons button.selected { background: var(--accent); color: #0b0a13; border-color: transparent; }
    .feedback-buttons button:disabled { opacity: 0.6; cursor: not-allowed; }

    @media (max-width:960px){ 
      .service-hero{grid-template-columns:1fr; padding-top:16px} 
      header{border-radius:20px; flex-direction:column; gap:16px; padding:16px}
      nav ul{width:100%; justify-content:center; flex-wrap:wrap}
      nav a{flex:1; min-width:120px; justify-content:center}
    }
  </style>
</head>
<body class="lang-en">
  <div class="aurora"></div>
  <div class="sparkles" id="sparkles"></div>

  <header>
    <div class="brand">
      <img src="Tsinghua_University_logo_and_wordmark_in_Chinese_and_English_characters.svg.png" alt="Tsinghua" />
      <h1>Mind-Mapper AI</h1>
    </div>
    <nav>
      <ul>
        <li><a href="#personality" class="nav-link personality-service active" data-section="personality">
          ğŸ§  <span data-lang="en">Personality Analysis</span><span data-lang="vi">PhÃ¢n tÃ­ch tÃ­nh cÃ¡ch</span><span data-lang="zh">æ€§æ ¼åˆ†æ</span>
        </a></li>
        <li><a href="#conflict" class="nav-link conflict-service" data-section="conflict">
          ğŸ¤ <span data-lang="en">Conflict Resolution</span><span data-lang="vi">Giáº£i quyáº¿t xung Ä‘á»™t</span><span data-lang="zh">å†²çªè§£å†³</span>
        </a></li>
        <li><a href="#about" class="nav-link">
          â„¹ï¸ <span data-lang="en">About</span><span data-lang="vi">Vá» chÃºng tÃ´i</span><span data-lang="zh">å…³äºæˆ‘ä»¬</span>
        </a></li>
        <li><a href="#faq" class="nav-link">â“ <span>FAQ</span></a></li>
        <li><a href="#contact" class="nav-link">
          ğŸ“§ <span data-lang="en">Contact</span><span data-lang="vi">LiÃªn há»‡</span><span data-lang="zh">è”ç³»</span>
        </a></li>
      </ul>
    </nav>
    <div class="lang pill">
      <span>ğŸŒ</span>
      <select id="language" aria-label="Language selector">
        <option value="en" selected>English</option>
        <option value="vi">Tiáº¿ng Viá»‡t</option>
        <option value="zh">ä¸­æ–‡</option>
      </select>
    </div>
  </header>

  <main class="container">
    <!-- Personality Analysis Section -->
    <section id="personality-section" class="service-section active">
      <div class="service-hero">
        <div>
          <h2 class="service-title personality-title">
            <span data-lang="en">Discover Your Personality</span>
            <span data-lang="vi">KhÃ¡m phÃ¡ tÃ­nh cÃ¡ch cá»§a báº¡n</span>
            <span data-lang="zh">æ¢ç´¢ä½ çš„æ€§æ ¼</span>
          </h2>
          <p class="subtitle">
            <span data-lang="en">A warm, human-like chat that reveals strengths, tendencies, and growth tips.</span>
            <span data-lang="vi">Cuá»™c trÃ² chuyá»‡n gáº§n gÅ©i giÃºp báº¡n hiá»ƒu rÃµ Ä‘iá»ƒm máº¡nh, xu hÆ°á»›ng vÃ  cÃ¡ch phÃ¡t triá»ƒn.</span>
            <span data-lang="zh">ä»¥è½»æ¾è‡ªç„¶çš„å¯¹è¯ï¼Œäº†è§£ä½ çš„ä¼˜åŠ¿ã€å€¾å‘ä¸æˆé•¿å»ºè®®ã€‚</span>
          </p>
          <p class="lead">
            <span data-lang="en">No rigid multiple-choiceâ€”just natural chat. Click the AI assistant below and start talking. After a brief exchange, you'll get a thoughtful MBTI-style profile, confidence level, and practical suggestions.</span>
            <span data-lang="vi">KhÃ´ng cáº§n tráº¯c nghiá»‡m cá»©ng nháº¯câ€”chá»‰ cáº§n trÃ² chuyá»‡n tá»± nhiÃªn. Má»Ÿ trá»£ lÃ½ bÃªn dÆ°á»›i vÃ  báº¯t Ä‘áº§u. Sau vÃ i tin nháº¯n, báº¡n sáº½ nháº­n Ä‘Æ°á»£c há»“ sÆ¡ kiá»ƒu MBTI, má»©c Ä‘á»™ tá»± tin vÃ  gá»£i Ã½ há»¯u Ã­ch.</span>
            <span data-lang="zh">æ— éœ€æ­»æ¿çš„é€‰æ‹©é¢˜ï¼Œåªéœ€è‡ªç„¶èŠå¤©ã€‚å¼€å¯ä¸‹æ–¹åŠ©æ‰‹å¹¶å¼€å§‹äº¤æµï¼›å¾ˆå¿«ä½ å°±ä¼šæ”¶åˆ° MBTI é£æ ¼çš„ç®€ä»‹ã€å¯ä¿¡åº¦ä»¥åŠå®ç”¨å»ºè®®ã€‚</span>
          </p>
          <a class="service-cta personality-cta" href="#" onclick="openPersonalityChat()">
            <span data-lang="en">Start Analysis</span>
            <span data-lang="vi">Báº¯t Ä‘áº§u phÃ¢n tÃ­ch</span>
            <span data-lang="zh">å¼€å§‹åˆ†æ</span> â†’
          </a>
        </div>
        <div class="illustrationWrap">
          <div class="card3d" id="personalityCard3d">
            <img class="hero-img" src="hero_image.png" alt="Professionals of diverse backgrounds"/>
          </div>
        </div>
      </div>

      <div class="when-to-use">
        <h3>
          <span data-lang="en">Perfect for when you want to:</span>
          <span data-lang="vi">HoÃ n háº£o khi báº¡n muá»‘n:</span>
          <span data-lang="zh">éå¸¸é€‚åˆå½“ä½ æƒ³è¦ï¼š</span>
        </h3>
        <div class="use-cases">
          <div class="use-case">
            <strong>ğŸ” <span data-lang="en">Self-Discovery</span><span data-lang="vi">Tá»± khÃ¡m phÃ¡</span><span data-lang="zh">è‡ªæˆ‘å‘ç°</span></strong><br>
            <span data-lang="en">Learn about your natural preferences and tendencies</span>
            <span data-lang="vi">TÃ¬m hiá»ƒu vá» sá»Ÿ thÃ­ch vÃ  xu hÆ°á»›ng tá»± nhiÃªn</span>
            <span data-lang="zh">äº†è§£ä½ çš„å¤©ç„¶åå¥½å’Œå€¾å‘</span>
          </div>
          <div class="use-case">
            <strong>ğŸš€ <span data-lang="en">Career Growth</span><span data-lang="vi">PhÃ¡t triá»ƒn sá»± nghiá»‡p</span><span data-lang="zh">èŒä¸šå‘å±•</span></strong><br>
            <span data-lang="en">Understand your work style and ideal environments</span>
            <span data-lang="vi">Hiá»ƒu phong cÃ¡ch lÃ m viá»‡c vÃ  mÃ´i trÆ°á»ng lÃ½ tÆ°á»Ÿng</span>
            <span data-lang="zh">ç†è§£ä½ çš„å·¥ä½œé£æ ¼å’Œç†æƒ³ç¯å¢ƒ</span>
          </div>
          <div class="use-case">
            <strong>ğŸ¤ <span data-lang="en">Relationships</span><span data-lang="vi">CÃ¡c má»‘i quan há»‡</span><span data-lang="zh">äººé™…å…³ç³»</span></strong><br>
            <span data-lang="en">Improve how you connect with others</span>
            <span data-lang="vi">Cáº£i thiá»‡n cÃ¡ch káº¿t ná»‘i vá»›i ngÆ°á»i khÃ¡c</span>
            <span data-lang="zh">æ”¹å–„ä¸ä»–äººçš„è¿æ¥æ–¹å¼</span>
          </div>
          <div class="use-case">
            <strong>ğŸ¯ <span data-lang="en">Personal Development</span><span data-lang="vi">PhÃ¡t triá»ƒn cÃ¡ nhÃ¢n</span><span data-lang="zh">ä¸ªäººå‘å±•</span></strong><br>
            <span data-lang="en">Get actionable tips for growth</span>
            <span data-lang="vi">Nháº­n lá»i khuyÃªn thá»±c táº¿ cho sá»± phÃ¡t triá»ƒn</span>
            <span data-lang="zh">è·å¾—å¯è¡Œçš„æˆé•¿å»ºè®®</span>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>
          <span data-lang="en">How it works</span>
          <span data-lang="vi">CÃ¡ch hoáº¡t Ä‘á»™ng</span>
          <span data-lang="zh">å¦‚ä½•è¿ä½œ</span>
        </h2>
        <div class="steps">
          <div class="step personality-step">
            <span class="n">1</span>
            <h3>
              <span data-lang="en">Start a natural chat</span>
              <span data-lang="vi">Báº¯t Ä‘áº§u trÃ² chuyá»‡n tá»± nhiÃªn</span>
              <span data-lang="zh">å¼€å§‹è‡ªç„¶å¯¹è¯</span>
            </h3>
            <p>
              <span data-lang="en">Say hello and share how you work, socialize, and make decisions.</span>
              <span data-lang="vi">HÃ£y chÃ o vÃ  chia sáº» cÃ¡ch báº¡n lÃ m viá»‡c, giao tiáº¿p vÃ  ra quyáº¿t Ä‘á»‹nh.</span>
              <span data-lang="zh">å…ˆæ‰“ä¸ªæ‹›å‘¼ï¼Œè¯´è¯´ä½ çš„å·¥ä½œæ–¹å¼ã€äººé™…äº’åŠ¨ä¸å†³ç­–ä¹ æƒ¯ã€‚</span>
            </p>
          </div>
          <div class="step personality-step">
            <span class="n">2</span>
            <h3>
              <span data-lang="en">AI listens and learns</span>
              <span data-lang="vi">AI láº¯ng nghe vÃ  há»c há»i</span>
              <span data-lang="zh">AI è®¤çœŸå€¾å¬å¹¶å­¦ä¹ </span>
            </h3>
            <p>
              <span data-lang="en">The assistant looks for patterns and refines insights over the chat.</span>
              <span data-lang="vi">Trá»£ lÃ½ tÃ¬m cÃ¡c máº«u hÃ nh vi vÃ  hoÃ n thiá»‡n nháº­n Ä‘á»‹nh trong suá»‘t cuá»™c trÃ² chuyá»‡n.</span>
              <span data-lang="zh">åŠ©æ‰‹åœ¨å¯¹è¯ä¸­è¯†åˆ«æ¨¡å¼ï¼Œä¸æ–­å®Œå–„ç»“è®ºã€‚</span>
            </p>
          </div>
          <div class="step personality-step">
            <span class="n">3</span>
            <h3>
              <span data-lang="en">Receive your profile</span>
              <span data-lang="vi">Nháº­n há»“ sÆ¡ cá»§a báº¡n</span>
              <span data-lang="zh">è·å–ä½ çš„ç”»åƒ</span>
            </h3>
            <p>
              <span data-lang="en">Get an MBTI-style type with confidence, traits, and friendly tips.</span>
              <span data-lang="vi">Nháº­n kiá»ƒu MBTI cÃ¹ng má»©c tá»± tin, Ä‘áº·c trÆ°ng chÃ­nh vÃ  gá»£i Ã½ há»¯u Ã­ch.</span>
              <span data-lang="zh">è·å¾— MBTI é£æ ¼ç±»å‹ã€å¯ä¿¡åº¦ã€å…³é”®ç‰¹è´¨å’Œè´´å¿ƒå»ºè®®ã€‚</span>
            </p>
          </div>
        </div>
      </div>

      <div class="feature-grid">
        <div class="feature-card personality-card">
          <h3>ğŸ—£ï¸ <span data-lang="en">Natural Conversation</span><span data-lang="vi">TrÃ² chuyá»‡n tá»± nhiÃªn</span><span data-lang="zh">è‡ªç„¶å¯¹è¯</span></h3>
          <p>
            <span data-lang="en">No rigid questionnairesâ€”just chat naturally about your preferences, work style, and decision-making.</span>
            <span data-lang="vi">KhÃ´ng cáº§n báº£ng cÃ¢u há»i cá»©ng nháº¯câ€”chá»‰ cáº§n trÃ² chuyá»‡n tá»± nhiÃªn vá» sá»Ÿ thÃ­ch, phong cÃ¡ch lÃ m viá»‡c vÃ  cÃ¡ch quyáº¿t Ä‘á»‹nh.</span>
            <span data-lang="zh">æ— éœ€æ­»æ¿é—®å·â€”åªéœ€è‡ªç„¶èŠèŠä½ çš„åå¥½ã€å·¥ä½œé£æ ¼å’Œå†³ç­–æ–¹å¼ã€‚</span>
          </p>
        </div>
        <div class="feature-card personality-card">
          <h3>ğŸ¯ <span data-lang="en">Accurate Analysis</span><span data-lang="vi">PhÃ¢n tÃ­ch chÃ­nh xÃ¡c</span><span data-lang="zh">ç²¾å‡†åˆ†æ</span></h3>
          <p>
            <span data-lang="en">Our AI analyzes patterns in your responses to determine your MBTI type with high confidence.</span>
            <span data-lang="vi">AI cá»§a chÃºng tÃ´i phÃ¢n tÃ­ch cÃ¡c máº«u trong pháº£n há»“i cá»§a báº¡n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh kiá»ƒu MBTI vá»›i Ä‘á»™ tin cáº­y cao.</span>
            <span data-lang="zh">æˆ‘ä»¬çš„ AI åˆ†æä½ çš„å›ç­”æ¨¡å¼ï¼Œä»¥é«˜å¯ä¿¡åº¦ç¡®å®šä½ çš„ MBTI ç±»å‹ã€‚</span>
          </p>
        </div>
        <div class="feature-card personality-card">
          <h3>ğŸ’¡ <span data-lang="en">Personalized Insights</span><span data-lang="vi">ThÃ´ng tin cÃ¡ nhÃ¢n hÃ³a</span><span data-lang="zh">ä¸ªæ€§åŒ–è§è§£</span></h3>
          <p>
            <span data-lang="en">Get specific strengths, growth areas, and practical tips tailored to your unique personality.</span>
            <span data-lang="vi">Nháº­n Ä‘Æ°á»£c nhá»¯ng Ä‘iá»ƒm máº¡nh cá»¥ thá»ƒ, lÄ©nh vá»±c phÃ¡t triá»ƒn vÃ  máº¹o thá»±c táº¿ phÃ¹ há»£p vá»›i tÃ­nh cÃ¡ch Ä‘á»™c Ä‘Ã¡o cá»§a báº¡n.</span>
            <span data-lang="zh">è·å¾—ä¸“é—¨é’ˆå¯¹ä½ ç‹¬ç‰¹æ€§æ ¼çš„å…·ä½“ä¼˜åŠ¿ã€æˆé•¿é¢†åŸŸå’Œå®ç”¨å»ºè®®ã€‚</span>
          </p>
        </div>
      </div>
    </section>

    <!-- Conflict Resolution Section -->
    <section id="conflict-section" class="service-section">
      <div class="service-hero">
        <div>
          <h2 class="service-title conflict-title">
            <span data-lang="en">Resolve Conflicts Wisely</span>
            <span data-lang="vi">Giáº£i quyáº¿t xung Ä‘á»™t thÃ´ng minh</span>
            <span data-lang="zh">æ˜æ™ºè§£å†³å†²çª</span>
          </h2>
          <p class="subtitle">
            <span data-lang="en">Get personalized strategies to resolve interpersonal conflicts using personality insights.</span>
            <span data-lang="vi">Nháº­n chiáº¿n lÆ°á»£c cÃ¡ nhÃ¢n hÃ³a Ä‘á»ƒ giáº£i quyáº¿t xung Ä‘á»™t giá»¯a con ngÆ°á»i dá»±a trÃªn hiá»ƒu biáº¿t vá» tÃ­nh cÃ¡ch.</span>
            <span data-lang="zh">åŸºäºæ€§æ ¼æ´å¯Ÿï¼Œè·å¾—ä¸ªæ€§åŒ–çš„äººé™…å†²çªè§£å†³ç­–ç•¥ã€‚</span>
          </p>
          <p class="lead">
            <span data-lang="en">Whether it's workplace tension, family disagreements, or team conflicts, our AI helps you understand the root causes and provides tailored resolution strategies based on personality types involved.</span>
            <span data-lang="vi">DÃ¹ lÃ  cÄƒng tháº³ng nÆ¡i lÃ m viá»‡c, báº¥t Ä‘á»“ng gia Ä‘Ã¬nh hay xung Ä‘á»™t nhÃ³m, AI cá»§a chÃºng tÃ´i giÃºp báº¡n hiá»ƒu nguyÃªn nhÃ¢n gá»‘c rá»… vÃ  cung cáº¥p chiáº¿n lÆ°á»£c giáº£i quyáº¿t phÃ¹ há»£p dá»±a trÃªn cÃ¡c kiá»ƒu tÃ­nh cÃ¡ch liÃªn quan.</span>
            <span data-lang="zh">æ— è®ºæ˜¯èŒåœºç´§å¼ ã€å®¶åº­åˆ†æ­§è¿˜æ˜¯å›¢é˜Ÿå†²çªï¼Œæˆ‘ä»¬çš„ AI å¸®ä½ ç†è§£æ ¹æœ¬åŸå› ï¼Œå¹¶åŸºäºæ¶‰åŠçš„æ€§æ ¼ç±»å‹æä¾›å®šåˆ¶åŒ–è§£å†³æ–¹æ¡ˆã€‚</span>
          </p>
          <a class="service-cta conflict-cta" href="#" onclick="openConflictChat()">
            <span data-lang="en">Get Help Now</span>
            <span data-lang="vi">Nháº­n trá»£ giÃºp ngay</span>
            <span data-lang="zh">ç«‹å³è·å¾—å¸®åŠ©</span> â†’
          </a>
        </div>
        <div class="illustrationWrap">
          <div class="card3d" id="conflictCard3d">
            <img class="hero-img" src="hero_image.png" alt="People resolving conflicts"/>
          </div>
        </div>
      </div>

      <div class="when-to-use">
        <h3>
          <span data-lang="en">Get help with:</span>
          <span data-lang="vi">Nháº­n trá»£ giÃºp vá»›i:</span>
          <span data-lang="zh">è·å¾—å¸®åŠ©è§£å†³ï¼š</span>
        </h3>
        <div class="use-cases">
          <div class="use-case">
            <strong>ğŸ’¬ <span data-lang="en">Communication Issues</span><span data-lang="vi">Váº¥n Ä‘á» giao tiáº¿p</span><span data-lang="zh">æ²Ÿé€šé—®é¢˜</span></strong><br>
            <span data-lang="en">Misunderstandings with colleagues or family</span>
            <span data-lang="vi">Hiá»ƒu láº§m vá»›i Ä‘á»“ng nghiá»‡p hoáº·c gia Ä‘Ã¬nh</span>
            <span data-lang="zh">ä¸åŒäº‹æˆ–å®¶äººçš„è¯¯è§£</span>
          </div>
          <div class="use-case">
            <strong>âš–ï¸ <span data-lang="en">Decision Deadlocks</span><span data-lang="vi">Báº¿ táº¯c quyáº¿t Ä‘á»‹nh</span><span data-lang="zh">å†³ç­–åƒµå±€</span></strong><br>
            <span data-lang="en">Can't agree on important choices</span>
            <span data-lang="vi">KhÃ´ng thá»ƒ Ä‘á»“ng Ã½ vá» cÃ¡c lá»±a chá»n quan trá»ng</span>
            <span data-lang="zh">æ— æ³•å°±é‡è¦é€‰æ‹©è¾¾æˆä¸€è‡´</span>
          </div>
          <div class="use-case">
            <strong>ğŸ‘¥ <span data-lang="en">Team Tensions</span><span data-lang="vi">CÄƒng tháº³ng nhÃ³m</span><span data-lang="zh">å›¢é˜Ÿç´§å¼ </span></strong><br>
            <span data-lang="en">Workplace conflicts affecting productivity</span>
            <span data-lang="vi">Xung Ä‘á»™t nÆ¡i lÃ m viá»‡c áº£nh hÆ°á»Ÿng nÄƒng suáº¥t</span>
            <span data-lang="zh">å½±å“ç”Ÿäº§åŠ›çš„èŒåœºå†²çª</span>
          </div>
          <div class="use-case">
            <strong>ğŸ’¼ <span data-lang="en">Work Style Clashes</span><span data-lang="vi">Xung Ä‘á»™t phong cÃ¡ch lÃ m viá»‡c</span><span data-lang="zh">å·¥ä½œé£æ ¼å†²çª</span></strong><br>
            <span data-lang="en">Different approaches causing friction</span>
            <span data-lang="vi">CÃ¡c cÃ¡ch tiáº¿p cáº­n khÃ¡c nhau gÃ¢y ma sÃ¡t</span>
            <span data-lang="zh">ä¸åŒæ–¹æ³•å¯¼è‡´çš„æ‘©æ“¦</span>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>
          <span data-lang="en">How conflict resolution works</span>
          <span data-lang="vi">CÃ¡ch giáº£i quyáº¿t xung Ä‘á»™t hoáº¡t Ä‘á»™ng</span>
          <span data-lang="zh">å†²çªè§£å†³å¦‚ä½•è¿ä½œ</span>
        </h2>
        <div class="steps">
          <div class="step conflict-step">
            <span class="n">1</span>
            <h3>
              <span data-lang="en">Describe the situation</span>
              <span data-lang="vi">MÃ´ táº£ tÃ¬nh huá»‘ng</span>
              <span data-lang="zh">æè¿°æƒ…å†µ</span>
            </h3>
            <p>
              <span data-lang="en">Tell us about the conflict, the people involved, and what's at stake.</span>
              <span data-lang="vi">HÃ£y cho chÃºng tÃ´i biáº¿t vá» xung Ä‘á»™t, nhá»¯ng ngÆ°á»i liÃªn quan vÃ  Ä‘iá»u gÃ¬ Ä‘ang bá»‹ Ä‘e dá»a.</span>
              <span data-lang="zh">å‘Šè¯‰æˆ‘ä»¬å†²çªæƒ…å†µã€æ¶‰åŠçš„äººå‘˜ä»¥åŠåˆ©å®³å…³ç³»ã€‚</span>
            </p>
          </div>
          <div class="step conflict-step">
            <span class="n">2</span>
            <h3>
              <span data-lang="en">AI analyzes patterns</span>
              <span data-lang="vi">AI phÃ¢n tÃ­ch máº«u hÃ¬nh</span>
              <span data-lang="zh">AI åˆ†ææ¨¡å¼</span>
            </h3>
            <p>
              <span data-lang="en">Our system identifies personality types and communication patterns causing the conflict.</span>
              <span data-lang="vi">Há»‡ thá»‘ng cá»§a chÃºng tÃ´i xÃ¡c Ä‘á»‹nh cÃ¡c kiá»ƒu tÃ­nh cÃ¡ch vÃ  máº«u giao tiáº¿p gÃ¢y ra xung Ä‘á»™t.</span>
              <span data-lang="zh">æˆ‘ä»¬çš„ç³»ç»Ÿè¯†åˆ«å¯¼è‡´å†²çªçš„æ€§æ ¼ç±»å‹å’Œæ²Ÿé€šæ¨¡å¼ã€‚</span>
            </p>
          </div>
          <div class="step conflict-step">
            <span class="n">3</span>
            <h3>
              <span data-lang="en">Get targeted solutions</span>
              <span data-lang="vi">Nháº­n giáº£i phÃ¡p cÃ³ má»¥c tiÃªu</span>
              <span data-lang="zh">è·å¾—é’ˆå¯¹æ€§è§£å†³æ–¹æ¡ˆ</span>
            </h3>
            <p>
              <span data-lang="en">Receive specific strategies, conversation scripts, and actionable steps to resolve the conflict.</span>
              <span data-lang="vi">Nháº­n cÃ¡c chiáº¿n lÆ°á»£c cá»¥ thá»ƒ, ká»‹ch báº£n cuá»™c trÃ² chuyá»‡n vÃ  cÃ¡c bÆ°á»›c hÃ nh Ä‘á»™ng Ä‘á»ƒ giáº£i quyáº¿t xung Ä‘á»™t.</span>
              <span data-lang="zh">è·å¾—å…·ä½“ç­–ç•¥ã€å¯¹è¯è„šæœ¬å’Œå¯è¡Œçš„è§£å†³æ­¥éª¤ã€‚</span>
            </p>
          </div>
        </div>
      </div>

      <div class="feature-grid">
        <div class="feature-card conflict-card">
          <h3>ğŸ” <span data-lang="en">Root Cause Analysis</span><span data-lang="vi">PhÃ¢n tÃ­ch nguyÃªn nhÃ¢n gá»‘c</span><span data-lang="zh">æ ¹æœ¬åŸå› åˆ†æ</span></h3>
          <p>
            <span data-lang="en">Understand why conflicts happen based on personality differences and communication styles.</span>
            <span data-lang="vi">Hiá»ƒu táº¡i sao xung Ä‘á»™t xáº£y ra dá»±a trÃªn sá»± khÃ¡c biá»‡t vá» tÃ­nh cÃ¡ch vÃ  phong cÃ¡ch giao tiáº¿p.</span>
            <span data-lang="zh">åŸºäºæ€§æ ¼å·®å¼‚å’Œæ²Ÿé€šé£æ ¼ç†è§£å†²çªå‘ç”Ÿçš„åŸå› ã€‚</span>
          </p>
        </div>
        <div class="feature-card conflict-card">
          <h3>ğŸ¯ <span data-lang="en">Targeted Strategies</span><span data-lang="vi">Chiáº¿n lÆ°á»£c cÃ³ má»¥c tiÃªu</span><span data-lang="zh">é’ˆå¯¹æ€§ç­–ç•¥</span></h3>
          <p>
            <span data-lang="en">Get specific resolution techniques tailored to the personality types involved.</span>
            <span data-lang="vi">Nháº­n cÃ¡c ká»¹ thuáº­t giáº£i quyáº¿t cá»¥ thá»ƒ phÃ¹ há»£p vá»›i cÃ¡c kiá»ƒu tÃ­nh cÃ¡ch liÃªn quan.</span>
            <span data-lang="zh">è·å¾—é’ˆå¯¹æ¶‰åŠæ€§æ ¼ç±»å‹çš„å…·ä½“è§£å†³æŠ€å·§ã€‚</span>
          </p>
        </div>
        <div class="feature-card conflict-card">
          <h3>ğŸ’¬ <span data-lang="en">Communication Scripts</span><span data-lang="vi">Ká»‹ch báº£n giao tiáº¿p</span><span data-lang="zh">æ²Ÿé€šè„šæœ¬</span></h3>
          <p>
            <span data-lang="en">Practice exact phrases and approaches that work for each personality type.</span>
            <span data-lang="vi">Luyá»‡n táº­p cÃ¡c cá»¥m tá»« vÃ  cÃ¡ch tiáº¿p cáº­n chÃ­nh xÃ¡c hoáº¡t Ä‘á»™ng cho tá»«ng kiá»ƒu tÃ­nh cÃ¡ch.</span>
            <span data-lang="zh">ç»ƒä¹ é€‚ç”¨äºæ¯ç§æ€§æ ¼ç±»å‹çš„ç¡®åˆ‡çŸ­è¯­å’Œæ–¹æ³•ã€‚</span>
          </p>
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section class="section" id="about">
      <h2>
        <span data-lang="en">About Group 61</span>
        <span data-lang="vi">Vá» NhÃ³m 61</span>
        <span data-lang="zh">å…³äºç¬¬ 61 ç»„</span>
      </h2>
      <p class="muted">
        <span data-lang="en">We are Group 61 from Tsinghua University's IEDE 2025 program. Mind-Mapper AI was born from our passion to use technology for self-awareness and growth.</span>
        <span data-lang="vi">ChÃºng tÃ´i lÃ  NhÃ³m 61 cá»§a chÆ°Æ¡ng trÃ¬nh IEDE 2025 (ÄH Thanh Hoa). Mind-Mapper AI ra Ä‘á»i tá»« mong muá»‘n dÃ¹ng cÃ´ng nghá»‡ Ä‘á»ƒ giÃºp má»i ngÆ°á»i hiá»ƒu mÃ¬nh vÃ  phÃ¡t triá»ƒn.</span>
        <span data-lang="zh">æˆ‘ä»¬æ¥è‡ªæ¸…åå¤§å­¦ IEDE 2025 é¡¹ç›®çš„ç¬¬ 61 ç»„ã€‚Mind-Mapper AI æºäºæˆ‘ä»¬å¸Œæœ›ç”¨æŠ€æœ¯å¸®åŠ©æ¯ä¸ªäººè‡ªæˆ‘è®¤çŸ¥ä¸æˆé•¿çš„çƒ­æƒ…ã€‚</span>
      </p>
      <p class="muted" style="margin-top:10px">
        <span data-lang="en">Our goal is to make personality analysis and conflict resolution accessible, engaging, and modern for everyone.</span>
        <span data-lang="vi">Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  Ä‘Æ°a phÃ¢n tÃ­ch tÃ­nh cÃ¡ch vÃ  giáº£i quyáº¿t xung Ä‘á»™t Ä‘áº¿n vá»›i má»i ngÆ°á»iâ€”dá»… tiáº¿p cáº­n, thÃº vá»‹ vÃ  hiá»‡n Ä‘áº¡i.</span>
        <span data-lang="zh">æˆ‘ä»¬çš„ç›®æ ‡ï¼šè®©æ€§æ ¼åˆ†æå’Œå†²çªè§£å†³æ›´æ˜“ç”¨ã€æ›´æœ‰è¶£ã€æ›´ç°ä»£ï¼ŒæœåŠ¡äºæ‰€æœ‰äººã€‚</span>
      </p>
    </section>

    <!-- FAQ Section -->
    <section class="section faq" id="faq">
      <h2>FAQ</h2>
      <details>
        <summary><span data-lang="en">What is the MBTI?</span><span data-lang="vi">MBTI lÃ  gÃ¬?</span><span data-lang="zh">ä»€ä¹ˆæ˜¯ MBTIï¼Ÿ</span></summary>
        <p><span data-lang="en">The Myers-Briggs Type Indicator describes preferences in how people perceive information and make decisions, grouping into 16 types.</span><span data-lang="vi">MBTI mÃ´ táº£ xu hÆ°á»›ng trong cÃ¡ch con ngÆ°á»i tiáº¿p nháº­n thÃ´ng tin vÃ  ra quyáº¿t Ä‘á»‹nh, gá»“m 16 kiá»ƒu tÃ­nh cÃ¡ch.</span><span data-lang="zh">MBTIï¼ˆè¿ˆå°”æ–¯-å¸ƒé‡Œæ ¼æ–¯æ€§æ ¼æŒ‡æ ‡ï¼‰æè¿°äººä»¬åœ¨ä¿¡æ¯æ„ŸçŸ¥ä¸å†³ç­–æ–¹å¼ä¸Šçš„åå¥½ï¼Œå…± 16 ç§ç±»å‹ã€‚</span></p>
      </details>
      <details>
        <summary><span data-lang="en">How does conflict resolution work?</span><span data-lang="vi">Giáº£i quyáº¿t xung Ä‘á»™t hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?</span><span data-lang="zh">å†²çªè§£å†³æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</span></summary>
        <p><span data-lang="en">Our AI analyzes the personalities and communication styles involved in your conflict, then provides tailored strategies and specific conversation approaches to help resolve the issue.</span><span data-lang="vi">AI cá»§a chÃºng tÃ´i phÃ¢n tÃ­ch cÃ¡c tÃ­nh cÃ¡ch vÃ  phong cÃ¡ch giao tiáº¿p liÃªn quan Ä‘áº¿n xung Ä‘á»™t cá»§a báº¡n, sau Ä‘Ã³ cung cáº¥p cÃ¡c chiáº¿n lÆ°á»£c phÃ¹ há»£p vÃ  cÃ¡ch tiáº¿p cáº­n cuá»™c trÃ² chuyá»‡n cá»¥ thá»ƒ Ä‘á»ƒ giÃºp giáº£i quyáº¿t váº¥n Ä‘á».</span><span data-lang="zh">æˆ‘ä»¬çš„ AI åˆ†æä½ å†²çªä¸­æ¶‰åŠçš„æ€§æ ¼å’Œæ²Ÿé€šé£æ ¼ï¼Œç„¶åæä¾›å®šåˆ¶ç­–ç•¥å’Œå…·ä½“çš„å¯¹è¯æ–¹æ³•æ¥å¸®åŠ©è§£å†³é—®é¢˜ã€‚</span></p>
      </details>
      <details>
        <summary><span data-lang="en">Is this a clinical assessment?</span><span data-lang="vi">ÄÃ¢y cÃ³ pháº£i Ä‘Ã¡nh giÃ¡ lÃ¢m sÃ ng?</span><span data-lang="zh">è¿™æ˜¯ä¸´åºŠè¯„ä¼°å—ï¼Ÿ</span></summary>
        <p><span data-lang="en">Noâ€”it's a self-reflection and guidance tool powered by AI. Use it for insights and guidance, not diagnosis.</span><span data-lang="vi">KhÃ´ngâ€”Ä‘Ã¢y lÃ  cÃ´ng cá»¥ tá»± pháº£n chiáº¿u vÃ  hÆ°á»›ng dáº«n do AI há»— trá»£. DÃ¹ng Ä‘á»ƒ tham kháº£o vÃ  hÆ°á»›ng dáº«n, khÃ´ng pháº£i cháº©n Ä‘oÃ¡n.</span><span data-lang="zh">ä¸æ˜¯ã€‚è¿™æ˜¯ä¸€ä¸ªç”± AI é©±åŠ¨çš„è‡ªæˆ‘åæ€å’ŒæŒ‡å¯¼å·¥å…·ï¼Œä»…ä¾›æ´å¯Ÿå’ŒæŒ‡å¯¼ï¼Œä¸ç”¨äºè¯Šæ–­ã€‚</span></p>
      </details>
      <details>
        <summary><span data-lang="en">Is my data private and secure?</span><span data-lang="vi">Dá»¯ liá»‡u cá»§a tÃ´i cÃ³ riÃªng tÆ° vÃ  an toÃ n?</span><span data-lang="zh">æˆ‘çš„æ•°æ®æ˜¯å¦å®‰å…¨ï¼Ÿ</span></summary>
        <p><span data-lang="en">We securely save anonymized conversations to improve our AI's accuracy and insights. We do not store any personal identification information.</span><span data-lang="vi">ChÃºng tÃ´i lÆ°u trá»¯ áº©n danh cÃ¡c cuá»™c trÃ² chuyá»‡n má»™t cÃ¡ch an toÃ n Ä‘á»ƒ cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c cá»§a AI. KhÃ´ng lÆ°u báº¥t ká»³ thÃ´ng tin Ä‘á»‹nh danh cÃ¡ nhÃ¢n nÃ o.</span><span data-lang="zh">æˆ‘ä»¬ä»…å®‰å…¨ä¿å­˜å·²åŒ¿ååŒ–çš„å¯¹è¯ï¼Œç”¨äºæå‡å‡†ç¡®åº¦ï¼›ä¸å­˜å‚¨ä»»ä½•å¯è¯†åˆ«ä¸ªäººçš„ä¿¡æ¯ã€‚</span></p>
      </details>
      <details>
        <summary><span data-lang="en">How long does it take?</span><span data-lang="vi">Máº¥t bao lÃ¢u?</span><span data-lang="zh">éœ€è¦å¤šä¹…ï¼Ÿ</span></summary>
        <p><span data-lang="en">Personality analysis usually takes 5â€“10 minutes to get a first profile. Conflict resolution varies depending on complexity but typically provides initial guidance within a few exchanges.</span><span data-lang="vi">PhÃ¢n tÃ­ch tÃ­nh cÃ¡ch thÆ°á»ng máº¥t 5â€“10 phÃºt Ä‘á»ƒ cÃ³ báº£n phÃ¢n tÃ­ch Ä‘áº§u tiÃªn. Giáº£i quyáº¿t xung Ä‘á»™t thay Ä‘á»•i tÃ¹y thuá»™c vÃ o Ä‘á»™ phá»©c táº¡p nhÆ°ng thÆ°á»ng cung cáº¥p hÆ°á»›ng dáº«n ban Ä‘áº§u trong vÃ i láº§n trao Ä‘á»•i.</span><span data-lang="zh">æ€§æ ¼åˆ†æé€šå¸¸ 5â€“10 åˆ†é’Ÿå³å¯è·å¾—åˆæ­¥ç”»åƒã€‚å†²çªè§£å†³å› å¤æ‚ç¨‹åº¦è€Œå¼‚ï¼Œä½†é€šå¸¸åœ¨å‡ æ¬¡äº¤æµå†…å°±èƒ½æä¾›åˆæ­¥æŒ‡å¯¼ã€‚</span></p>
      </details>
    </section>

    <!-- Contact Section -->
    <section class="section" id="contact">
      <h2><span data-lang="en">Get in touch</span><span data-lang="vi">LiÃªn há»‡</span><span data-lang="zh">è”ç³»æˆ‘ä»¬</span></h2>
      <form id="contactForm">
        <div class="field">
          <label><span data-lang="en">Name</span><span data-lang="vi">TÃªn</span><span data-lang="zh">å§“å</span></label>
          <input id="contact-name" required data-lang-en-placeholder="Your name" data-lang-vi-placeholder="TÃªn cá»§a báº¡n" data-lang-zh-placeholder="ä½ çš„åå­—" />
        </div>
        <div class="field" style="margin-top:10px">
          <label><span data-lang="en">Email</span><span data-lang="vi">Email</span><span data-lang="zh">é‚®ç®±</span></label>
          <input id="contact-email" type="email" required data-lang-en-placeholder="you@example.com" data-lang-vi-placeholder="ban@example.com" data-lang-zh-placeholder="ni@example.com" />
        </div>
        <div class="field" style="margin-top:10px">
          <label><span data-lang="en">Message</span><span data-lang="vi">Tin nháº¯n</span><span data-lang="zh">ç•™è¨€</span></label>
          <textarea id="contact-message" rows="5" required data-lang-en-placeholder="How can we help?" data-lang-vi-placeholder="ChÃºng tÃ´i cÃ³ thá»ƒ giÃºp gÃ¬?" data-lang-zh-placeholder="æˆ‘ä»¬èƒ½å¦‚ä½•å¸®åŠ©ä½ ï¼Ÿ"></textarea>
        </div>
        <button class="btn" style="margin-top:12px">
          <span data-lang="en">Send message</span>
          <span data-lang="vi">Gá»­i tin nháº¯n</span>
          <span data-lang="zh">å‘é€</span>
        </button>
      </form>
    </section>
  </main>

  <!-- Chat Launch Buttons -->
  <button class="chat-launch personality-chat" id="personalityChatOpen" title="Chat with Personality AI" style="display:none;">
    <img src="mascot.png" alt="Personality AI Mascot" />
  </button>

  <button class="chat-launch conflict conflict-chat" id="conflictChatOpen" title="Chat with Conflict Resolution AI" style="display:none;">
    <img src="mascot.png" alt="Conflict Resolution AI Mascot" />
  </button>

  <!-- Chat Panels -->
  <div class="chat-panel personality-panel" id="personalityChatPanel" aria-live="polite">
    <div class="chat-head personality-head">
      <h3><span data-lang="en">Personality Analyst</span><span data-lang="vi">ChuyÃªn gia TÃ­nh cÃ¡ch</span><span data-lang="zh">æ€§æ ¼åˆ†æå¸ˆ</span></h3>
    </div>
    <div class="chat-body" id="personalityChatBody"></div>
    <div class="chat-foot" id="personalityChatFoot">
      <div id="personalityInputArea" style="display:grid; grid-template-columns: 1fr auto; gap: 8px;">
        <input id="personalityChatInput" placeholder="Type your messageâ€¦" />
        <button class="btn" id="personalitySendBtn">
          <span data-lang="en">Send</span>
          <span data-lang="vi">Gá»­i</span>
          <span data-lang="zh">å‘é€</span>
        </button>
      </div>
      <button class="btn" id="personalityResetBtn" style="display:none; width:100%;">
        <span data-lang="en">Start New Analysis</span>
        <span data-lang="vi">Báº¯t Ä‘áº§u phÃ¢n tÃ­ch má»›i</span>
        <span data-lang="zh">å¼€å§‹æ–°çš„åˆ†æ</span>
      </button>
    </div>
  </div>

  <div class="chat-panel conflict-panel" id="conflictChatPanel" aria-live="polite">
    <div class="chat-head conflict-head">
      <h3><span data-lang="en">Conflict Resolution Specialist</span><span data-lang="vi">ChuyÃªn gia Giáº£i quyáº¿t Xung Ä‘á»™t</span><span data-lang="zh">å†²çªè§£å†³ä¸“å®¶</span></h3>
    </div>
    <div class="chat-body" id="conflictChatBody"></div>
    <div class="chat-foot" id="conflictChatFoot">
      <div id="conflictInputArea" style="display:grid; grid-template-columns: 1fr auto; gap: 8px;">
        <input id="conflictChatInput" placeholder="Describe your conflictâ€¦" />
        <button class="btn" id="conflictSendBtn">
          <span data-lang="en">Send</span>
          <span data-lang="vi">Gá»­i</span>
          <span data-lang="zh">å‘é€</span>
        </button>
      </div>
      <button class="btn" id="conflictResetBtn" style="display:none; width:100%;">
        <span data-lang="en">Start New Session</span>
        <span data-lang="vi">Báº¯t Ä‘áº§u phiÃªn má»›i</span>
        <span data-lang="zh">å¼€å§‹æ–°ä¼šè¯</span>
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // --- 1. Supabase Configuration ---
    const supa_url = 'https://okbqkkftdxazdfkiovjj.supabase.co';
    const supa_anon_key = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9rYnFra2Z0ZHhhemRma2lvdmpqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDUxOTEsImV4cCI6MjA3MDcyMTE5MX0.SvYI1lxJP-dzEK5j1xGNdJu-pNtWEzVm7S2wnQBMY9c';
    const supabaseClient = supabase.createClient(supa_url, supa_anon_key);

    // Globals
    let personalityHistory = [];
    let conflictHistory = [];
    let currentService = 'personality';
    let latestPersonalityProgress = null;

    // --- 2. Utility Functions ---
    function initializeSparkles() { 
      const host = document.getElementById('sparkles'); 
      if (!host || host.children.length) return;
      for(let i=0;i<120;i++){ 
        const s=document.createElement('i'); 
        s.style.left=Math.random()*100+'vw';
        s.style.top='100vh';
        s.style.animationDuration=(10+Math.random()*16)+'s'; 
        host.appendChild(s);
      } 
    }

    function initializeTilt() { 
      const personalityCard = document.getElementById('personalityCard3d');
      const conflictCard = document.getElementById('conflictCard3d'); 
      [personalityCard, conflictCard].forEach(card => {
        if (!card) return;
        let b = card.getBoundingClientRect(); 
        window.addEventListener('resize', () => b = card.getBoundingClientRect()); 
        card.addEventListener('mousemove', e => { 
          const x=(e.clientX-b.left)/b.width-0.5; 
          const y=(e.clientY-b.top)/b.height-0.5; 
          card.style.transform=`perspective(1000px) rotateX(${-y*6}deg) rotateY(${x*8}deg)`; 
        }); 
        card.addEventListener('mouseleave', () => { card.style.transform='perspective(1000px) rotateX(0) rotateY(0)';}); 
      });
    }

    function initializeLanguage() {
      const sel = document.getElementById('language');
      if (!sel) return;

      function applyPlaceholders() { 
        const lang = document.body.classList.contains('lang-vi') ? 'vi' :
                     document.body.classList.contains('lang-zh') ? 'zh' : 'en';
        document.querySelectorAll('[data-lang-en-placeholder]').forEach(el => { 
          const txt = el.getAttribute(`data-lang-${lang}-placeholder`); 
          if(txt) el.placeholder = txt; 
        }); 
      }
      
      function setLang(lang) { 
        document.body.classList.remove('lang-en','lang-vi','lang-zh'); 
        document.body.classList.add('lang-' + lang); 
        localStorage.setItem('preferredLanguage', lang); 
        applyPlaceholders();
        // Refresh initial messages
        displayPersonalityInitialMessage();
        displayConflictInitialMessage();
      }
      
      const saved = localStorage.getItem('preferredLanguage') || 'en'; 
      sel.value = saved; 
      setLang(saved); 
      sel.addEventListener('change', e => setLang(e.target.value));
    }

    // --- 3. Navigation ---
    function initializeNavigation() {
      const navLinks = document.querySelectorAll('.nav-link[data-section]');
      const sections = document.querySelectorAll('.service-section');
      
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          const targetSection = this.dataset.section;
          
          // Update active nav link
          navLinks.forEach(nl => nl.classList.remove('active'));
          this.classList.add('active');
          
          // Update visible section
          sections.forEach(section => section.classList.remove('active'));
          document.getElementById(targetSection + '-section').classList.add('active');
          
          // Update current service and show appropriate chat button
          currentService = targetSection;
          updateChatButtons();
          
          // Update URL without page reload
          history.pushState(null, '', '#' + targetSection);
        });
      });
      
      // Handle direct URL access
      const hash = window.location.hash.slice(1);
      if (hash && (hash === 'personality' || hash === 'conflict')) {
        const targetLink = document.querySelector(`[data-section="${hash}"]`);
        if (targetLink) {
          targetLink.click();
        }
      }
    }

    function updateChatButtons() {
      const personalityBtn = document.getElementById('personalityChatOpen');
      const conflictBtn = document.getElementById('conflictChatOpen');
      
      if (currentService === 'personality') {
        personalityBtn.style.display = 'block';
        conflictBtn.style.display = 'none';
      } else if (currentService === 'conflict') {
        personalityBtn.style.display = 'none';
        conflictBtn.style.display = 'block';
      } else {
        personalityBtn.style.display = 'none';
        conflictBtn.style.display = 'none';
      }
    }

    // --- 4. Service Launch Functions ---
    function openPersonalityChat() {
      currentService = 'personality';
      updateChatButtons();
      document.getElementById('personalityChatPanel').classList.add('open');
      document.getElementById('personalityChatInput').focus();
    }

    function openConflictChat() {
      currentService = 'conflict';
      updateChatButtons();
      document.getElementById('conflictChatPanel').classList.add('open');
      document.getElementById('conflictChatInput').focus();
    }

    // --- 5. Chat Panel Functions ---
    function initializeChatPanels() {
      // Personality chat
      const personalityOpen = document.getElementById('personalityChatOpen');
      const personalityPanel = document.getElementById('personalityChatPanel');
      if (personalityOpen && personalityPanel) {
        personalityOpen.onclick = () => { 
          personalityPanel.classList.toggle('open');
          if (personalityPanel.classList.contains('open')) {
            if (latestPersonalityProgress && latestPersonalityProgress.current_step < latestPersonalityProgress.total_steps) {
              updatePersonalityProgressBar(latestPersonalityProgress);
            }
            document.getElementById('personalityChatInput').focus();
          }
        };
      }

      // Conflict chat
      const conflictOpen = document.getElementById('conflictChatOpen');
      const conflictPanel = document.getElementById('conflictChatPanel');
      if (conflictOpen && conflictPanel) {
        conflictOpen.onclick = () => { 
          conflictPanel.classList.toggle('open');
          if (conflictPanel.classList.contains('open')) {
            document.getElementById('conflictChatInput').focus();
          }
        };
      }
    }

    // --- 6. Contact Form Handler ---
    async function handleContactSubmit(event) {
        event.preventDefault();
        const form = event.target;
        const submitButton = form.querySelector('button');
        
        const formData = {
            name: document.getElementById('contact-name').value,
            email: document.getElementById('contact-email').value,
            message: document.getElementById('contact-message').value,
            lang: localStorage.getItem('preferredLanguage') || 'en',
            user_agent: navigator.userAgent
        };

        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';

        try {
            const { data, error } = await supabaseClient
                .from('contact_messages')
                .insert([formData]);

            if (error) throw error;

            alert(document.body.classList.contains('lang-vi') ? 'Cáº£m Æ¡n! ChÃºng tÃ´i Ä‘Ã£ nháº­n Ä‘Æ°á»£c tin nháº¯n cá»§a báº¡n.' :
                  document.body.classList.contains('lang-zh') ? 'è°¢è°¢ï¼æˆ‘ä»¬å·²æ”¶åˆ°ä½ çš„ç•™è¨€ã€‚' :
                  'Thanks! We have received your message.');
            form.reset();

        } catch (error) {
            console.error('Error submitting contact form:', error.message);
            alert('Sorry, there was an error sending your message. Please try again.');
        
        } finally {
            submitButton.disabled = false;
            const lang = document.body.className.split(' ').find(c => c.startsWith('lang-')).split('-')[1] || 'en';
            submitButton.innerHTML = form.querySelector(`[data-lang="${lang}"]`).outerHTML;
        }
    }

    // --- 7. Chat Messaging Functions ---
    function displayPersonalityInitialMessage() {
      const chatBody = document.getElementById('personalityChatBody');
      if (!chatBody) return;
      const isVI = document.body.classList.contains('lang-vi');
      const isZH = document.body.classList.contains('lang-zh');
      chatBody.innerHTML = ''; 
      const initialMsg = document.createElement('div');
      initialMsg.className = 'msg ai';
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      let welcomeText;
      if (isVI) {
        welcomeText = `ChÃ o báº¡n! CÃ¹ng trÃ² chuyá»‡n má»™t chÃºt vá» tÃ­nh cÃ¡ch nhÃ©. Báº¡n cá»© thoáº£i mÃ¡i chia sáº» cÃ¡ch lÃ m viá»‡c, giao tiáº¿p hay ra quyáº¿t Ä‘á»‹nh. MÃ¬nh sáº½ láº¯ng nghe vÃ  giÃºp báº¡n hiá»ƒu mÃ¬nh hÆ¡n. ğŸ˜Š`;
      } else if (isZH) {
        welcomeText = `ä½ å¥½ï¼æˆ‘ä»¬æ¥è½»æ¾èŠèŠä½ çš„æ€§æ ¼å§ã€‚å¯ä»¥éšæ„è¯´è¯´ä½ çš„å·¥ä½œæ–¹å¼ã€äººé™…ç›¸å¤„æˆ–è€…å†³ç­–ä¹ æƒ¯ã€‚æˆ‘ä¼šè®¤çœŸå€¾å¬å¹¶ç»™å‡ºæœ‰ç”¨çš„åé¦ˆã€‚ğŸ˜Š`;
      } else {
        welcomeText = `Hey there! Let's chat a bit about your personality. Tell me how you like to work, socialize, or make decisions. I'm here to listen and help you learn more about yourself. ğŸ˜Š`;
      }
      bubble.innerHTML = `<span>${welcomeText}</span>`;
      initialMsg.appendChild(bubble);
      chatBody.appendChild(initialMsg);
      personalityHistory = [{ role: 'assistant', content: welcomeText }];
    }

    function displayConflictInitialMessage() {
      const chatBody = document.getElementById('conflictChatBody');
      if (!chatBody) return;
      const isVI = document.body.classList.contains('lang-vi');
      const isZH = document.body.classList.contains('lang-zh');
      chatBody.innerHTML = ''; 
      const initialMsg = document.createElement('div');
      initialMsg.className = 'msg ai';
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      let welcomeText;
      if (isVI) {
        welcomeText = `Xin chÃ o! TÃ´i lÃ  chuyÃªn gia giáº£i quyáº¿t xung Ä‘á»™t cá»§a báº¡n. ğŸ¤

HÃ£y mÃ´ táº£ tÃ¬nh huá»‘ng báº¡n Ä‘ang gáº·p pháº£i - ai lÃ  nhá»¯ng ngÆ°á»i liÃªn quan vÃ  Ä‘iá»u gÃ¬ Ä‘ang gÃ¢y ra cÄƒng tháº³ng? 

TÃ´i sáº½ giÃºp báº¡n:
â€¢ Hiá»ƒu rÃµ nguyÃªn nhÃ¢n gá»‘c rá»…
â€¢ ÄÆ°a ra cÃ¡c chiáº¿n lÆ°á»£c phÃ¹ há»£p  
â€¢ Cung cáº¥p nhá»¯ng cÃ¢u nÃ³i cá»¥ thá»ƒ báº¡n cÃ³ thá»ƒ dÃ¹ng
â€¢ TÃ¬m ra giáº£i phÃ¡p cÃ³ lá»£i cho táº¥t cáº£ má»i ngÆ°á»i

Cá»© thoáº£i mÃ¡i chia sáº» nhÃ©!`;
      } else if (isZH) {
        welcomeText = `ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„å†²çªè§£å†³ä¸“å®¶ã€‚ğŸ¤

è¯·æè¿°ä¸€ä¸‹ä½ é‡åˆ°çš„æƒ…å†µâ€”â€”æ¶‰åŠå“ªäº›äººï¼Œä»€ä¹ˆåŸå› å¯¼è‡´äº†ç´§å¼ å…³ç³»ï¼Ÿ

æˆ‘ä¼šå¸®ä½ ï¼š
â€¢ ç†è§£æ ¹æœ¬åŸå› 
â€¢ æä¾›é’ˆå¯¹æ€§ç­–ç•¥
â€¢ ç»™å‡ºå…·ä½“çš„è¡¨è¾¾å»ºè®®
â€¢ æ‰¾åˆ°å¯¹æ‰€æœ‰äººéƒ½æœ‰åˆ©çš„è§£å†³æ–¹æ¡ˆ

è¯·éšæ„åˆ†äº«ä½ çš„æƒ…å†µï¼`;
      } else {
        welcomeText = `Hello! I'm your conflict resolution specialist. ğŸ¤

Please describe the situation you're dealing with - who's involved and what's causing the tension?

I'll help you:
â€¢ Understand the root causes
â€¢ Develop targeted strategies  
â€¢ Get specific phrases you can use
â€¢ Find solutions that work for everyone

Feel free to share what's going on!`;
      }
      bubble.innerHTML = `<span>${welcomeText}</span>`;
      initialMsg.appendChild(bubble);
      chatBody.appendChild(initialMsg);
      conflictHistory = [{ role: 'assistant', content: welcomeText }];
    }

    function appendMessage(service, role, text, conversationId = null, showFeedback = false) { 
      const chatBody = document.getElementById(service + 'ChatBody');
      if (!chatBody) return;
      const wrap = document.createElement('div'); 
      wrap.className = 'msg ' + (role === 'user' ? `user ${service}` : 'ai');
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      let processedText = text
        .replace(/</g,'&lt;')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') 
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/\n/g,'<br>');
      bubble.innerHTML = processedText;
      if (role === 'ai' && conversationId && showFeedback) {
        const fb = document.createElement('div');
        fb.className = 'feedback-buttons';
        fb.innerHTML = `
          <button data-convo-id="${conversationId}" data-rating="true">ğŸ‘ Accurate</button>
          <button data-convo-id="${conversationId}" data-rating="false">ğŸ‘ Not Quite</button>`;
        bubble.appendChild(fb);
      }
      wrap.appendChild(bubble);
      chatBody.appendChild(wrap); 
      chatBody.scrollTop = chatBody.scrollHeight; 
    }

    function showTyping(service) {
      const chatBody = document.getElementById(service + 'ChatBody');
      if (!chatBody) return;
      const wrap = document.createElement('div');
      wrap.className = 'msg ai typing';
      wrap.id = service + '-typing-indicator';
      wrap.innerHTML = `<div class="bubble">Typing...</div>`;
      chatBody.appendChild(wrap);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function hideTyping(service){ 
      const t = document.getElementById(service + '-typing-indicator'); 
      if(t) t.remove(); 
    }

    function updatePersonalityProgressBar(progress) {
      if (progress && progress.current_step >= progress.total_steps) {
        const ex = document.getElementById('personality-progress-container'); if (ex) ex.remove();
        latestPersonalityProgress = null; return;
      }
      let pc = document.getElementById('personality-progress-container');
      if (!pc) {
        pc = document.createElement('div');
        pc.id = 'personality-progress-container';
        pc.style.cssText = `
          padding: 8px 14px;border-bottom:1px solid var(--glass-stroke);
          background: rgba(255,255,255,.03); text-align:center; font-size:12px;
          color: var(--muted); font-weight:500; flex-shrink:0;`;
        const head = document.querySelector('#personalityChatPanel .chat-head');
        if (head && head.parentNode) head.parentNode.insertBefore(pc, head.nextSibling);
      }
      if (progress) {
        const count = Object.values(progress.dimensions_explored || {}).filter(Boolean).length;
        pc.innerHTML = `Analysis Progress: Dimensions Explored ${count}/4`;
      }
    }

    async function handleFeedback(conversationId, isAccurate) {
      try {
        const buttons = document.querySelectorAll(`button[data-convo-id="${conversationId}"]`);
        buttons.forEach(b => b.disabled = true);
        const res = await fetch('/.netlify/functions/save-feedback', {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ conversation_id:Number(conversationId), is_accurate:Boolean(isAccurate) })
        });
        if (!res.ok) throw new Error(await res.text() || `HTTP ${res.status}`);
        buttons.forEach(btn => {
          if (btn.getAttribute('data-rating') === String(isAccurate)) {
            btn.textContent = isAccurate ? 'âœ… Thanks!' : 'ğŸ“ Noted';
            btn.classList.add('selected');
          }
        });
      } catch (error) {
        console.error('Error saving feedback:', error);
        alert('Could not save feedback: ' + (error.message || String(error)));
        const buttons = document.querySelectorAll(`button[data-convo-id="${conversationId}"]`);
        buttons.forEach(b => b.disabled = false);
      }
    }

    function initializeFeedbackHandlers() {
      document.getElementById('personalityChatBody').addEventListener('click', (e) => {
        const t = e.target;
        if (t.tagName === 'BUTTON' && t.hasAttribute('data-convo-id')) {
          const id = t.getAttribute('data-convo-id');
          const ok = t.getAttribute('data-rating') === 'true';
          handleFeedback(id, ok);
        }
      });

      document.getElementById('conflictChatBody').addEventListener('click', (e) => {
        const t = e.target;
        if (t.tagName === 'BUTTON' && t.hasAttribute('data-convo-id')) {
          const id = t.getAttribute('data-convo-id');
          const ok = t.getAttribute('data-rating') === 'true';
          handleFeedback(id, ok);
        }
      });
    }

    // --- 8. Personality Chat Handler ---
    async function handlePersonalitySend() {
      const input = document.getElementById('personalityChatInput');
      if (!input) return;
      const text = input.value.trim(); 
      if (!text) return; 
      input.value=''; 
      appendMessage('personality', 'user', text);
      personalityHistory.push({ role:'user', content:text });
      showTyping('personality');
      
      try {
        const messages = personalityHistory.slice(-10);
        
        console.log('ğŸ” SENDING PERSONALITY REQUEST');
        
        // Call the dedicated personality function
        const res = await fetch('/.netlify/functions/personality-chat', {
          method:'POST', 
          headers:{'Content-Type':'application/json'}, 
          body:JSON.stringify({ 
            messages,
            language: localStorage.getItem('preferredLanguage') || 'en'
          })
        });
        
        if (!res.ok) {
          const errorData = await res.json().catch(() => ({}));
          throw new Error(errorData.error || `HTTP ${res.status}: Request failed`);
        }
        
        const data = await res.json();
        hideTyping('personality');
        
        if (data.reply) {
          try {
            const mbtiResult = JSON.parse(data.reply);
            personalityHistory.push({ role:'assistant', content:data.reply });
            
            if (mbtiResult.progress) { 
              latestPersonalityProgress = mbtiResult.progress; 
              updatePersonalityProgressBar(latestPersonalityProgress); 
            }
            
            let responseText = '';
            let isActualResult = false;
            
            if (mbtiResult.ready_for_analysis === true && mbtiResult.type && mbtiResult.type !== 'Unknown') {
              isActualResult = true;
              responseText = `ğŸ¯ **Your MBTI Type: ${mbtiResult.type}**\n`;
              responseText += `ğŸ“Š Confidence: ${Math.round(mbtiResult.confidence * 100)}%\n\n`;
              if (mbtiResult.one_liner) responseText += `ğŸ’­ *${mbtiResult.one_liner}*\n\n`;
              if (mbtiResult.reasoning) responseText += `**My Analysis:**\n${mbtiResult.reasoning}\n\n`;
              if (mbtiResult.strengths?.length) {
                responseText += `âœ¨ **Your Strengths:**\n`; 
                mbtiResult.strengths.forEach(s => responseText += `â€¢ ${s}\n`); 
                responseText += '\n';
              }
              if (mbtiResult.growth_tips?.length) {
                responseText += `ğŸŒ± **Growth Tips:**\n`; 
                mbtiResult.growth_tips.forEach(t => responseText += `â€¢ ${t}\n`); 
              }
              document.getElementById('personalityInputArea').style.display='none';
              document.getElementById('personalityResetBtn').style.display='block';
            } else {
              responseText = mbtiResult.one_liner || 'I need a bit more information. Can you tell me more?';
            }
            
            appendMessage('personality', 'ai', responseText, data.conversation_id, isActualResult);
            
          } catch (e) {
            console.error('JSON parse error:', e);
            appendMessage('personality', 'ai', data.reply);
            personalityHistory.push({ role:'assistant', content:data.reply });
          }
        } else {
          appendMessage('personality', 'ai', 'Sorry, I received an unexpected response format.');
        }
      } catch (err) { 
        hideTyping('personality'); 
        handleChatError('personality', err);
      }
    }

    // --- 9. Conflict Chat Handler ---
    function formatConflictResponse(conflictData) {
      let formatted = '';
      
      // Handle error responses
      if (conflictData.status === 'error') {
        return conflictData.main_response || 'I encountered an error. Please try again.';
      }
      
      // Main response (always present)
      if (conflictData.main_response) {
        formatted += conflictData.main_response;
      }
      
      // Add conflict analysis if present
      if (conflictData.conflict_analysis) {
        formatted += '\n\n**ğŸ’¡ What I see happening:**\n';
        formatted += conflictData.conflict_analysis;
      }
      
      // Add insights if present
      if (conflictData.insights && conflictData.insights.length > 0) {
        formatted += '\n\n**ğŸ” Key Insights:**\n';
        conflictData.insights.forEach(insight => {
          formatted += `â€¢ ${insight}\n`;
        });
      }
      
      // Add resolution strategies if present
      if (conflictData.resolution_strategies && conflictData.resolution_strategies.length > 0) {
        formatted += '\n\n**ğŸ› ï¸ Resolution Strategies:**\n';
        conflictData.resolution_strategies.forEach((strategy, index) => {
          formatted += `\n**${index + 1}. ${strategy.strategy}**\n`;
          formatted += `${strategy.description}\n`;
          
          if (strategy.example_phrases && strategy.example_phrases.length > 0) {
            formatted += `\n*Try saying:*\n`;
            strategy.example_phrases.forEach(phrase => {
              formatted += `ğŸ’¬ "${phrase}"\n`;
            });
          }
        });
      }
      
      // Add action steps if present
      if (conflictData.action_steps && conflictData.action_steps.length > 0) {
        formatted += '\n\n**ğŸ“‹ Your Next Steps:**\n';
        conflictData.action_steps.forEach((step, index) => {
          formatted += `${index + 1}. ${step}\n`;
        });
      }
      
      // Add prevention tips if present
      if (conflictData.prevention_tips && conflictData.prevention_tips.length > 0) {
        formatted += '\n\n**ğŸ›¡ï¸ Future Prevention:**\n';
        conflictData.prevention_tips.forEach(tip => {
          formatted += `â€¢ ${tip}\n`;
        });
      }
      
      // Add key questions if present
      if (conflictData.key_questions && conflictData.key_questions.length > 0) {
        formatted += '\n\n**â“ To help me understand better:**\n';
        conflictData.key_questions.forEach(question => {
          formatted += `â€¢ ${question}\n`;
        });
      }
      
      // Add next steps if present (different from action_steps)
      if (conflictData.next_steps && conflictData.next_steps.length > 0) {
        formatted += '\n\n**ğŸ¯ What I'll help you with next:**\n';
        conflictData.next_steps.forEach(step => {
          formatted += `â€¢ ${step}\n`;
        });
      }
      
      return formatted.trim();
    }

    async function handleConflictSend() {
      const input = document.getElementById('conflictChatInput');
      if (!input) return;
      const text = input.value.trim(); 
      if (!text) return; 
      input.value=''; 
      appendMessage('conflict', 'user', text);
      conflictHistory.push({ role:'user', content:text });
      showTyping('conflict');
      
      try {
        const messages = conflictHistory.slice(-10);
        
        console.log('ğŸ” SENDING CONFLICT REQUEST');
        
        // Call the dedicated conflict function
        const res = await fetch('/.netlify/functions/conflict-chat', {
          method:'POST', 
          headers:{'Content-Type':'application/json'}, 
          body:JSON.stringify({ 
            messages,
            language: localStorage.getItem('preferredLanguage') || 'en'
          })
        });
        
        if (!res.ok) {
          const errorData = await res.json().catch(() => ({}));
          throw new Error(errorData.error || `HTTP ${res.status}: Request failed`);
        }
        
        const data = await res.json();
        
        console.log('ğŸ” RECEIVED CONFLICT RESPONSE:', data);
        
        hideTyping('conflict');
        
        if (data.reply) {
          try {
            const conflictResult = JSON.parse(data.reply);
            conflictHistory.push({ role:'assistant', content:data.reply });
            
            console.log('ğŸ” PARSED CONFLICT JSON:', conflictResult);
            
            // Format the conflict response for user-friendly display
            const formattedResponse = formatConflictResponse(conflictResult);
            appendMessage('conflict', 'ai', formattedResponse, data.conversation_id, false);
            
          } catch (parseError) {
            console.error('âŒ Failed to parse conflict JSON:', parseError);
            conflictHistory.push({ role:'assistant', content:data.reply });
            appendMessage('conflict', 'ai', data.reply, data.conversation_id, false);
          }
        } else {
          appendMessage('conflict', 'ai', 'Sorry, I received an unexpected response format.');
        }
      } catch (err) { 
        hideTyping('conflict'); 
        handleChatError('conflict', err);
      }
    }

    // --- 10. Shared Error Handler ---
    function handleChatError(service, error) {
      if (error.message.includes('Too many requests')) {
        appendMessage(service, 'ai', 'I\'m receiving a lot of requests right now. Please wait a minute and try again.');
      } else if (error.message.includes('Origin not allowed')) {
        appendMessage(service, 'ai', 'There seems to be a security issue. Please refresh the page and try again.');
      } else {
        appendMessage(service, 'ai', `Sorry, I encountered an error: ${error.message}. Please try again.`); 
      }
    }

    function resetPersonalityChat() {
      displayPersonalityInitialMessage();
      document.getElementById('personalityInputArea').style.display = 'grid';
      document.getElementById('personalityResetBtn').style.display = 'none';
      document.getElementById('personalityChatInput').focus();
      latestPersonalityProgress = null;
      const pc = document.getElementById('personality-progress-container');
      if (pc) pc.remove();
    }

    function resetConflictChat() {
      displayConflictInitialMessage();
      document.getElementById('conflictInputArea').style.display = 'grid';
      document.getElementById('conflictResetBtn').style.display = 'none';
      document.getElementById('conflictChatInput').focus();
    }

    function initializeChatControls() {
      // Personality controls
      const personalitySendBtn = document.getElementById('personalitySendBtn');
      const personalityResetBtn = document.getElementById('personalityResetBtn');
      const personalityInput = document.getElementById('personalityChatInput');
      
      if (personalitySendBtn) personalitySendBtn.addEventListener('click', handlePersonalitySend);
      if (personalityResetBtn) personalityResetBtn.addEventListener('click', resetPersonalityChat);
      if (personalityInput) {
        personalityInput.addEventListener('keydown', e => { 
          if (e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); handlePersonalitySend(); }
        });
      }

      // Conflict controls
      const conflictSendBtn = document.getElementById('conflictSendBtn');
      const conflictResetBtn = document.getElementById('conflictResetBtn');
      const conflictInput = document.getElementById('conflictChatInput');
      
      if (conflictSendBtn) conflictSendBtn.addEventListener('click', handleConflictSend);
      if (conflictResetBtn) conflictResetBtn.addEventListener('click', resetConflictChat);
      if (conflictInput) {
        conflictInput.addEventListener('keydown', e => { 
          if (e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); handleConflictSend(); }
        });
      }

      initializeFeedbackHandlers();
      displayPersonalityInitialMessage();
      displayConflictInitialMessage();
    }

    // --- 11. Initialize Everything ---
    document.addEventListener('DOMContentLoaded', () => {
      initializeSparkles();
      initializeTilt();
      initializeLanguage();
      initializeNavigation();
      initializeChatPanels();
      initializeChatControls();
      updateChatButtons();

      const contactForm = document.getElementById('contactForm');
      if (contactForm) {
          contactForm.addEventListener('submit', handleContactSubmit);
      }

      // Make functions globally available
      window.openPersonalityChat = openPersonalityChat;
      window.openConflictChat = openConflictChat;
    });
  </script>
</body>
</html>